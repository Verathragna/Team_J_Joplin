# OneNote Converter

This package is used to process OneNote backup files and output HTML that Joplin can import.

The code is based on the projects created by https://github.com/msiemens

We adapted it to target WebAssembly, adding Node.js functions that could interface with the host machine. For that to  happen we are using custom-made functions (see `node_functions.js`) and the Node.js standard library (see `src/utils.rs`).


### Project structure:

```
- onenote-converter
    - package.json          -> file to store scripts on how to build the project
    - node_functions.js     -> where the custom-made functions used inside rust goes
    ...
    - pkg                   -> artifact folder generated by wasm-pack
        - package.json      -> library that gets used by the Joplin Project
    ...
    - src
        - lib.rs            -> starting point
```

### How to develop:

To work with the code you will need:

- Rust https://www.rust-lang.org/learn/get-started

To build, inside the `onenote-converter/package.json` I added two scripts to build it to release and dev, `buildProduction` and `buildDev`. For the dev build it might print out a lot of logs, but they can be disabled in the macro `log!()`

During development, it will be easier to test it where this library is called. `InteropService_Importer_Onenote.ts` is the code that depends on this and already has some tests.


### Postinstall script

There is a `postinstall` script that checks if the `NODE_ENV` is production and if it is it will try to build the library. If for some reason a developer might need to test the library or run on another environment value it is only necessary to run `buildProduction` or `buildDev` to generate the necessary files.


### Security concerns

We are using WebAssembly with Node.js calls to the file system, reading and writing files and directories, which means
it is not isolated (no more than Node.js is, for that matter). 